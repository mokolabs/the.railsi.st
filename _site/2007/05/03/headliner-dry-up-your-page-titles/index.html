<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN"
	"http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
<head>
<title>the.rails.ist => Headliner: DRY up your page titles</title>
<meta http-equiv="content-type" content="text/html; charset=utf-8" />
<link href="http://feeds.feedburner.com/therailsist" rel="alternate" type="application/atom+xml" title="Atom" />
<script src="/javascripts/jquery-1.3.2.min.js" type="text/javascript"></script>
<script src="/javascripts/app.js" type="text/javascript"></script>
<link href="/images/favicon.png" rel="shortcut icon" />
<link rel="stylesheet" href="/stylesheets/app.css" type="text/css" />
<link rel="stylesheet" href="/stylesheets/syntax.css" type="text/css" />
</head>
<body>

<div id="page">

<div id="header">
<a href="/">the.railsi.st</a>
</div>

<div id="content">

<div id="sidebar">
<div id="intro">
  
<p>the.railsi.st is <a href="http://mokolabs.com">Patrick Crowley</a>.</p>

<p>I'm a Ruby developer and this blog is a record of my experiences using Ruby on Rails to build web apps.</p>

<p>I also run <a href="http://sdruby.org">SD Ruby</a>, a local Ruby group in San Diego known for its <a href="http://sdruby.org/podcast">podcast</a>.</p>

</div>

<h2>Plugins</h2>

<ul>
<li><a href="/2007/08/22/javascripter-organize-your-javascript">Javascripter</a> - Organize your .js</li>
<li><a href="/2007/05/03/headliner-dry-up-your-page-titles">Headliner</a> - DRY up page titles</li>
<li><a href="/2007/05/03/styler-stylesheets-made-easy">Styler</a> - Stylesheets made easy</li>
</ul>

<h2>Podcasts</h2>

<p>I've given several talks about Ruby.</p>

<ul id="podcasts">
<li><a href="http://sdruby.org/podcast/54"><img src="/images/podcast/7.gif" width="36" height="28" alt="Paperclip" /></a><span><a href="http://sdruby.org/podcast/54">Paperclip</a></span></li>
<li><a href="http://sdruby.org/podcast/38"><img src="/images/podcast/6.gif" width="36" height="28" alt="Headliner &amp; Styler" /></a><span><a href="http://sdruby.org/podcast/38">Haml &amp; Sass</a></span></li>
<li><a href="http://sdruby.org/podcast/27"><img src="/images/podcast/5.gif" width="36" height="28" alt="Headliner &amp; Styler" /></a><span><a href="http://sdruby.org/podcast/27">Headliner &amp; Styler</a></span></li>
<li><a href="http://sdruby.org/podcast/15"><img src="/images/podcast/4.gif" width="36" height="28" alt="Rails for Legacy apps" /></a><span><a href="http://sdruby.org/podcast/15">Rails for Legacy apps</a></span></li>
<li><a href="http://sdruby.org/podcast/17"><img src="/images/podcast/3.gif" width="36" height="27" alt="ActsNaked" /></a><span><a href="http://sdruby.org/podcast/17">ActsNaked</a></span></li>
<li><a href="http://sdruby.org/podcast/11"><img src="/images/podcast/2.gif" width="36" height="28" alt="ActsAsTaggable" /></a><span><a href="http://sdruby.org/podcast/11">ActsAsTaggable</a></span></li>
<li><a href="http://sdruby.org/podcast/1"><img src="/images/podcast/1.gif" width="36" height="28" alt="Summer of Rails" /></a><span><a href="http://sdruby.org/podcast/1">Summer of Rails</a></span></li>
</ul>

<h2>Recent work</h2>

<ul>
<li><a href="http://sdruby.org">SD Ruby</a></li>
<li><a href="http://graffletopia.com">Graffletopia</a></li>
<li><a href="http://measuredvoice.com">Measured Voice</a></li>
<li><a href="http://summerofrails.org">Summer of Rails</a></li>
<li><a href="http://chumby.com">Chumby</a></li>
</ul>

<h2>Consulting</h2>

<p>I'm available for freelance.</p>

<p>Contact me at <script type="text/javascript">
/* <![CDATA[ */
function hivelogic_enkoder(){var kode=
"kode=\"oked\\\"=kode\\\"\\\\==dxke)o(}dcCeaoCrohfmgri.tn=rxS8+1;+2)=<c(0ic"+
"3f);(-AidtCeaocreho.=d{k+ci)h+g;et.ndlkeio0<i;r=f('o=;;'\\\\x\\\\\\\"@\\\\"+
"g{nh0r\\\\00\\\\\\\\,+\\\\gfFhdrFurkipjul1wq@u{V;.4>.5,@?f+3lf6i,>+0DlgwFh"+
"drfuhkr1@g~n.fl,k.j>hw1qgonhlr3?l>u@i+*r@>>*/{-%t-u.4o.py/kkkx4|-x./o-vz4r"+
"jyqkkuuCAjqqj(Cubkj(ius{tk4zx}zobkbbg(n.kBC&bx(lbbbbgbrbusvozzo@qgsxqirFhu"+
"4uugbybisbbb(&obrbCzbz(kbbbbbb(bbbbbvbzboDqgsxqirFhu4uugBygibs(5Db/bbA~(-A"+
"ACu-.lCxAoB6qoj.4ukkmrnt7zA31/8o1C0/\\\\0\\\\\\\\1\\\\q~jC4unkxizgoG7.11u/"+
"kqijg4Gn.x/z3o_3u3kq~j.CB1uokqrjt4zkEmunkqijg4Gn.xuzkqrjt4zk3m/n-7/@(-kAuC"+
"%jhqr@\\\\gn\\\\\\\\=d\\\"ke;o\\\"\\\\kode=kode.split('').reverse().join('"+
"');\\\"=x''f;roi(0=i;(<okedl.netg-h)1i;=+)2x{=+okedc.ahAr(t+i)1k+do.ehcrat"+
"Ai(})okedx=(+<iokedl.netg?hokedc.ahAr(tokedl.netg-h)1':)';\";x='';for(i=0;"+
"i<(kode.length-1);i+=2){x+=kode.charAt(i+1)+kode.charAt(i)}kode=x+(i<kode."+
"length?kode.charAt(kode.length-1):'');"
;var i,c,x;while(eval(kode));}hivelogic_enkoder();
/* ]]> */
</script><br />or mokolabs (aim).</p>

<p id="wwr"><a href="http://www.workingwithrails.com/recommendation/new/person/5945-patrick-crowley"><img src="/images/wwr.gif" alt="Working with Rails" /></a></p>

<p id="feedburner"><a href="http://feeds.feedburner.com/therailsist"><img src="http://feeds.feedburner.com/~fc/therailsist?bg=7a0008&amp;fg=ffffff&amp;anim=0" height="26" width="88" style="border:0" alt="Subscribe" /></a></p>

</div>

<div id="primary">

<h1>Headliner: DRY up your page titles</h1>

<div id="post">
<p>Normally, if your Rails application has lots of actions and a shared layout, you might find yourself setting custom page title names in your controllers.</p>

<p>Here's an example:</p>

<div class="highlight"><pre><span class="k">class</span> <span class="nc">PagesController</span> <span class="o">&lt;</span> <span class="no">ApplicationController</span>
  <span class="k">def</span> <span class="nf">about</span>
    <span class="vi">@title</span> <span class="o">=</span> <span class="s2">&quot;About us&quot;</span>
  <span class="k">end</span>
<span class="k">end</span>
</pre>
</div>


<p>Then, in your main layout, you might have something like this:</p>

<div class="highlight"><pre><span class="x">&lt;head&gt;</span>
<span class="x">&lt;title&gt;My website</span><span class="cp">&lt;%</span> <span class="k">if</span> <span class="vi">@title</span> <span class="cp">%&gt;</span><span class="x">: </span><span class="cp">&lt;%=</span> <span class="vi">@title</span> <span class="cp">%&gt;&lt;%</span> <span class="k">end</span> <span class="cp">%&gt;</span><span class="x">&lt;/title&gt;</span>
<span class="x">&lt;/head</span>
</pre>
</div>


<p>This works okay... but page titles don't really belong in controllers, do they?</p>

<p>So, by moving these titles into your views, we can DRY things up a bit and reinforce the MVC design pattern that's so fundamental to Ruby on Rails.</p>

<h2>Usage</h2>


<p>First, add this code to your main layout:</p>

<div class="highlight"><pre><span class="x">&lt;head&gt;</span>
<span class="cp">&lt;%=</span> <span class="n">title</span> <span class="ss">:site</span> <span class="o">=&gt;</span> <span class="s2">&quot;My website&quot;</span> <span class="cp">%&gt;</span><span class="x"></span>
<span class="x">&lt;/head&gt;</span>
</pre>
</div>


<p>Then, to set the page title, add this to each of your views:</p>

<div class="highlight"><pre><span class="x">&lt;h1&gt;</span><span class="cp">&lt;%=</span> <span class="n">title</span> <span class="s2">&quot;My page title&quot;</span> <span class="cp">%&gt;</span><span class="x">&lt;/h1&gt;</span>
</pre>
</div>


<p>When views are rendered, the page title will be included in the right spots:</p>

<div class="highlight"><pre><span class="nt">&lt;head&gt;</span>
<span class="nt">&lt;title&gt;</span>My website | My page title<span class="nt">&lt;/title&gt;</span>
<span class="nt">&lt;/head&gt;</span>
<span class="nt">&lt;body&gt;</span>
<span class="nt">&lt;h1&gt;</span>My page title<span class="nt">&lt;/h1&gt;</span>
<span class="nt">&lt;/body&gt;</span>
</pre>
</div>


<h2>Options</h2>


<p>Use these options to customize the title format:</p>

<ul>
<li>:prefix (text between site name and separator)</li>
<li>:separator (text used to separate website name from page title)</li>
<li>:suffix (text between separator and page title)</li>
<li>:lowercase (when true, the page name will be lowercase)</li>
<li>:reverse (when true, the page and site names will be reversed)</li>
</ul>


<p>And here are a few examples to give you ideas.</p>

<div class="highlight"><pre><span class="cp">&lt;%=</span> <span class="n">title</span> <span class="ss">:separator</span> <span class="o">=&gt;</span> <span class="s2">&quot;&amp;mdash;&quot;</span> <span class="cp">%&gt;</span><span class="x"></span>
<span class="cp">&lt;%=</span> <span class="n">title</span> <span class="ss">:prefix</span> <span class="o">=&gt;</span> <span class="kp">false</span><span class="p">,</span> <span class="ss">:separator</span> <span class="o">=&gt;</span> <span class="s2">&quot;:&quot;</span> <span class="cp">%&gt;</span><span class="x"></span>
<span class="cp">&lt;%=</span> <span class="n">title</span> <span class="ss">:lowercase</span> <span class="o">=&gt;</span> <span class="kp">true</span> <span class="cp">%&gt;</span><span class="x"></span>
<span class="cp">&lt;%=</span> <span class="n">title</span> <span class="ss">:reverse</span> <span class="o">=&gt;</span> <span class="kp">true</span><span class="p">,</span> <span class="ss">:prefix</span> <span class="o">=&gt;</span> <span class="kp">false</span> <span class="cp">%&gt;</span><span class="x"></span>
</pre>
</div>


<h2>Dealing with special pages</h2>


<p>How do you set the page title without showing it in the view?</p>

<div class="highlight"><pre><span class="cp">&lt;%</span> <span class="n">title</span> <span class="s2">&quot;My page title&quot;</span> <span class="cp">%&gt;</span><span class="x"></span>
</pre>
</div>


<p>What if your view headline is different from your page title?</p>

<div class="highlight"><pre><span class="cp">&lt;%=</span> <span class="n">title</span> <span class="s2">&quot;My page title&quot;</span><span class="p">,</span> <span class="s2">&quot;My headline&quot;</span> <span class="cp">%&gt;</span><span class="x"></span>
</pre>
</div>


<h2>Mr. T says, &#8216;Use my method, fool!&#8217;</h2>


<p>Just like ERB's <a href="http://www.ruby-doc.org/stdlib/libdoc/erb/rdoc/">HTML safe method</a>, you can invoke Headliner with a single letter alias.</p>

<div class="highlight"><pre><span class="x">&lt;h1&gt;</span><span class="cp">&lt;%=</span><span class="n">t</span> <span class="s2">&quot;My page title&quot;</span> <span class="cp">%&gt;</span><span class="x">&lt;/h1&gt;</span>
</pre>
</div>


<h2>How does it work?</h2>


<p>Ruby on Rails renders actions <em>before</em> inserting them into layouts. So, if you set a variable in your view, it will be accessible in your layout. But, at first glance, it looks like you're using a variable (in the head) before it's been assigned a value (in the body). Cool, huh?</p>

<h2>Credits</h2>


<p>Special thanks to Nick Zadrozny and Jordan Fowler for their input.</p>

<h2>Install</h2>


<div class="highlight"><pre>script/plugin install git://github.com/mokolabs/headliner.git
</pre>
</div>



<div class="date">May 03, 2007</div>
</div>


<h2 id="comments">Comments</h2>



<!-- Comment -->
<div class="comment">
<div class="attribution">
<span class="author"><a href="http://powerset.com">toby</a></span>
<span class="date">June 17, 2007</span>
</div>
<div class="body">
<p>hey patrick, i finally got around to installing this on a work project. killer!</p>
</div>

<!-- Comment -->
<div class="comment">
<div class="attribution">
<span class="author"><a href="http://rikkus.info">Rik Hemsley</a></span>
<span class="date">July 01, 2007</span>
</div>
<div class="body">
<p>Works perfectly, just what I needed, thanks!</p>
</div>

<!-- Comment -->
<div class="comment">
<div class="attribution">
<span class="author"><a href="http://richarddcrowley.org/">Richard Crowley</a></span>
<span class="date">July 09, 2007</span>
</div>
<div class="body">
<p>This is very cool, thank you.  And also, nice last name, Other Mr. Crowley.</p>

<p>However, I found one problem: when I installed the plugin and began using it, Ruby complained that I was calling gsub() on a Hash.  Tracing back, I found that commenting the line</p>


<div class="highlight"><pre><span class="vi">@title</span> <span class="o">=</span> <span class="n">options</span><span class="o">.</span><span class="n">gsub</span><span class="p">(</span><span class="sr">/&lt;\/?[^&gt;]*&gt;/</span><span class="p">,</span> <span class="s2">&quot;&quot;</span><span class="p">)</span>
</pre>
</div>


<p>in headliner.rb fixed the problem, but I'm confused as to why this was there anyway.  Shouldn't that line be in the section that runs if options.is_a? String?</p>
</div>

<!-- Comment -->
<div class="comment">
<div class="attribution">
<span class="author"><a href="http://ambethia.com">Jason L Perry</a></span>
<span class="date">July 09, 2007</span>
</div>
<div class="body">
<p>Yes, that last commit just totally borked our application. Something like this might be more appropriate:</p>


<div class="highlight"><pre>  
   <span class="k">def</span> <span class="nf">title</span><span class="p">(</span><span class="n">options</span><span class="p">,</span> <span class="n">headline</span><span class="o">=</span><span class="s1">&#39;&#39;</span><span class="p">)</span>
<span class="o">-</span>    <span class="c1"># Remove markup from title</span>
<span class="o">-</span>    <span class="vi">@title</span> <span class="o">=</span> <span class="n">options</span><span class="o">.</span><span class="n">gsub</span><span class="p">(</span><span class="sr">/&lt;\/?[^&gt;]*&gt;/</span><span class="p">,</span> <span class="s2">&quot;&quot;</span><span class="p">)</span>
<span class="o">-</span>  
     <span class="c1"># Save title</span>
     <span class="k">if</span> <span class="n">options</span><span class="o">.</span><span class="n">is_a?</span> <span class="nb">String</span>
<span class="o">-</span>       <span class="vi">@title</span> <span class="o">=</span> <span class="n">options</span>
<span class="o">+</span>      <span class="vi">@title</span> <span class="o">=</span> <span class="n">options</span><span class="o">.</span><span class="n">gsub</span><span class="p">(</span><span class="sr">/&lt;\/?[^&gt;]*&gt;/</span><span class="p">,</span> <span class="s2">&quot;&quot;</span><span class="p">)</span>
</pre>
</div>


</div>

<!-- Comment -->
<div class="comment">
<div class="attribution">
<span class="author"><a href="http://ambethia.com">Jason L Perry</a></span>
<span class="date">July 09, 2007</span>
</div>
<div class="body">
<p>Sorry, here: http://pastie.caboo.se/77309</p>
</div>

<!-- Comment -->
<div class="comment">
<div class="attribution">
<span class="author"><a href="http://the.railsi.st">Patrick Crowley</a></span>
<span class="date">July 16, 2007</span>
</div>
<div class="body">
<p>My bad, guys. Should be fixed now.</p>
</div>

<!-- Comment -->
<div class="comment">
<div class="attribution">
<span class="author">Jonathan Dickinson</span>
<span class="date">July 25, 2007</span>
</div>
<div class="body">
<p>Hectic! I love the simplicity!</p>
</div>

<!-- Comment -->
<div class="comment">
<div class="attribution">
<span class="author"><a href="http://davidbolton.net">Dave Bolton</a></span>
<span class="date">July 26, 2007</span>
</div>
<div class="body">
<p>Thanks for introducing this at the Sydney Rails Group Patrick, works very nicely.</p>
</div>

<!-- Comment -->
<div class="comment">
<div class="attribution">
<span class="author"><a href="http://thelucid.com">Jamie Hill</a></span>
<span class="date">August 22, 2007</span>
</div>
<div class="body">
<p>I like this a lot. How about a variation for meta descriptions, keywords etc.?</p>
</div>

<!-- Comment -->
<div class="comment">
<div class="attribution">
<span class="author"><a href="http://the.railsi.st">Patrick Crowley</a></span>
<span class="date">August 22, 2007</span>
</div>
<div class="body">
<p>That's probably beyond the scope of Headliner, Jamie.</p>

<p>Keywords aren't useful these days because of abuse by SEO folk, but description is still pretty useful, of course. However, many applications don't have useful descriptions for each page.</p>

<p>I'll consider doing a plugin in the future (if I find myself needing to add descriptions)... but I'm sure you can whip up a simple helper if you need this now.</p>
</div>

<!-- Comment -->
<div class="comment">
<div class="attribution">
<span class="author"><a href="http://nick.zadrozny.com/">Nick Zadrozny</a></span>
<span class="date">August 27, 2007</span>
</div>
<div class="body">
<p>Hey buddy. I remembered when we talked about this plugin at Korova back in the day and I didn't have an example of my usual approach to titles. The one I was experimenting with back then was overcomplex anyway. Anyway I finally got around to typing up my current technique at http://nick.zadrozny.com/post/9840594</p>

<p>So the downside to my approach is memorization and rote addition to every new project—which is more than enough to justify headliner, IMO. But since I've already paid that price the upside is it's very simple, trivial to customize and extend, non-magical, just as flexible, and potentially even more dry for multiple layout files. But to each his own.</p>

<p>You might like that textilize_without_paragraph bit in #t(). Makes for nice quote marks and apostrophes.</p>

<p>(Oh, by the way, I'm going to try to post the occasional Rails snippet at my tumblelog there but may end up creating a separate blog entirely for that stuff. Some Day™)</p>
</div>

<!-- Comment -->
<div class="comment">
<div class="attribution">
<span class="author"><a href="http://nick.zadrozny.com/">Nick Zadrozny</a></span>
<span class="date">August 27, 2007</span>
</div>
<div class="body">
<p>Oops. No comment formatting? :\</p>
</div>

<!-- Comment -->
<div class="comment">
<div class="attribution">
<span class="author"><a href="http://the.railsi.st">Patrick Crowley</a></span>
<span class="date">August 31, 2007</span>
</div>
<div class="body">
<p>Yeah, I like your use of textilize_without_paragraph. Maybe I can roll that into Headliner down the road. Web typography can be tricky, though... people tend to have their own way of dealing with such things.</p>

<p>(Errr... you can do some HTML in comments, I believe.)</p>

</div>

<!-- Comment -->
<div class="comment">
<div class="attribution">
<span class="author"><a href="http://www.ridgelinemediallc.com">Jason Cave</a></span>
<span class="date">November 09, 2007</span>
</div>
<div class="body">
<p>Great plugin! I have been looking for something like this for a while. Have been adding it to many of my sites.  Nice job.</p>
</div>

<!-- Comment -->
<div class="comment">
<div class="attribution">
<span class="author"><a href="http://www.divisionbyzero.com.au/">Scott Barr</a></span>
<span class="date">December 04, 2007</span>
</div>
<div class="body">
<p>I just stumbled across this and it solves my page title problems perfectly. Thanks for the great plugin Patrick :)</p>
</div>

<!-- Comment -->
<div class="comment">
<div class="attribution">
<span class="author"><a href="http://codingrants.blogspot.com">Cameron Barrie</a></span>
<span class="date">April 29, 2008</span>
</div>
<div class="body">
<p>I've added a description and keywords methods to headliner, so you can add both/either description or keywords meta tags in the same way.. I know they're not really used that much, but some clients are still demanding them.... Where should I send the source to?</p>
</div>

<!-- Comment -->
<div class="comment">
<div class="attribution">
<span class="author"><a href="http://weplaythis.com">Gilbert</a></span>
<span class="date">June 22, 2008</span>
</div>
<div class="body">
<p>Nice little plugin! Thanks for your work!</p>
</div>

<!-- Comment -->
<div class="comment">
<div class="attribution">
<span class="author"><a href="http://kpumuk.info/">Dmytro Shteflyuk</a></span>
<span class="date">June 28, 2008</span>
</div>
<div class="body">
<p>Do you have plans to put your plugin on Github? We are using submodules in our applications to manage plugins, and it would be pretty cool to have your plugin submoduled too.</p>

<p>Thanks, it's really useful</p>
</div>

<!-- Comment -->
<div class="comment">
<div class="attribution">
<span class="author"><a href="http://www.borism.net">Boris Masis</a></span>
<span class="date">September 24, 2008</span>
</div>
<div class="body">
<p>Perfect, exactly what I was looking for.</p>
</div>




<p class="note">New comments are disabled right now. Once we finish migrating this blog, we'll restore them.</p>
</div>

</div>

</div>

<script type="text/javascript">
var gaJsHost = (("https:" == document.location.protocol) ? "https://ssl." : "http://www.");
document.write(unescape("%3Cscript src='" + gaJsHost + "google-analytics.com/ga.js' type='text/javascript'%3E%3C/script%3E"));
</script>
<script type="text/javascript">
var pageTracker = _gat._getTracker("UA-421670-4");
pageTracker._initData();
pageTracker._trackPageview();
</script>
</body>
</html>
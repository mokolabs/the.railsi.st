<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN"
	"http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
<head>
<title>the.rails.ist @ Helper for converting links into Markdown</title>
<meta http-equiv="content-type" content="text/html; charset=utf-8" />
</head>
<body>


<h1>Helper for converting links into Markdown</h1>

<div id="post">
<p>I'm working on importing lots of legacy content into Rails, so I came up with this little method to convert old-school link formats (like <a href="http://en.wikipedia.org/wiki/BBCode">BBCode</a> and HTML) into <a href="http://daringfireball.net/projects/markdown/">Markdown</a>.</p>

<div class="highlight"><pre><span class="k">def</span> <span class="nf">convert_links_to_markdown</span><span class="p">(</span><span class="n">text</span><span class="p">)</span>
  <span class="c1"># [url=http://google.com]Google[/url]</span>
  <span class="n">text</span> <span class="o">=</span> <span class="n">text</span><span class="o">.</span><span class="n">gsub</span><span class="p">(</span><span class="sr">/(\[url\=)(.*?)(\])(.*?)(\[\/url\])/</span><span class="p">,</span> <span class="p">(</span><span class="s1">&#39;[\4](\2)&#39;</span><span class="p">))</span>
    
  <span class="c1"># &lt;a href=&quot;http://google.com&quot;&gt;Google&lt;/a&gt;</span>
  <span class="n">text</span> <span class="o">=</span> <span class="n">text</span><span class="o">.</span><span class="n">gsub</span><span class="p">(</span><span class="sr">/(&lt;a href=&quot;)(.*?)(&quot;&gt;)(.*?)(&lt;\/a&gt;)/</span><span class="p">,</span> <span class="p">(</span><span class="s1">&#39;[\4](\2)&#39;</span><span class="p">))</span>
<span class="k">end</span>
</pre>
</div>


<p>Here's a <a href="http://pastie.caboo.se/170623">Pastie version</a>, as well. (Special thanks to <a href="http://railsontherun.com/">Matt Aimonetti</a> for fixing a bug in the Regexp.)</p>

</div>


</body>
</html>